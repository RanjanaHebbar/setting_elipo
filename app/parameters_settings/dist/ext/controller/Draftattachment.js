sap.ui.define(["sap/m/MessageBox","sap/m/MessageToast","sap/ui/core/UIComponent"],function(e,t,n){"use strict";function o(n,o){var r;function a(e){r&&r.getBeginButton().setEnabled(e)}function s(e){r.setBusy(e)}function i(){r&&r.close()}function l(t,n,o){e.error("Upload failed",{title:"Error"})}function u(e){return sap.ui.core.Fragment.byId("excelUploadDialog",e)}return{onBeforeOpen:function(e){r=e.getSource();n.addDependent(r)},onAfterClose:function(e){n.removeDependent(r);r.destroy();r=undefined},_getBaseURL:function(){debugger;var e=this.getOwnerComponent().getManifestEntry("/sap.app/id").replaceAll(".","/");return jQuery.sap.getModulePath(e)},onFileChange:function(e){var t=e.getParameters("files").files[0];this.file=t},onOk:function(e){debugger;var t=new FileReader;t.onload=function(e){debugger;this.content=e.currentTarget.result;this.createfile()}.bind(this);t.readAsDataURL(this.file)},createfile:function(){debugger;var t=this.file;var n="https://elipo_backend-shy-echidna-yp.cfapps.us20.hana.ondemand.com/dev/company-logo";var o=new FormData;o.append("file",t);o.append("file_name","company_logo");fetch(n,{method:"POST",body:o}).then(function(e){if(e.status===200){return e.text()}else{throw new Error("POST request failed with status: "+e.status)}}).then(function(t){var n=JSON.parse(t);if(n.statusCode===200){var o="File Uploaded Successfully";e.success(o);i();console.log("Success: "+n.body)}else{var o="Failed to upload";e.error("Failed to upload");i();console.log("Error: "+n.body)}}).catch(function(e){console.error(e)})},onCancel:function(e){i()},onTypeMismatch:function(e){var t=e.getSource().getFileType().map(function(e){return"*."+e}).join(", ");l("The file type *."+e.getParameter("fileType")+" is not supported. Choose one of the following types: "+t)},onFileAllowed:function(e){a(true)},onFileEmpty:function(e){a(false)},onUploadComplete:function(e){var o=e.getParameter("status");var r=e.getSource();r.clear();a(false);s(false);if(o>=400){var u;try{u=JSON.parse(e.getParameter("responseRaw"))}catch(t){u=e.getParameter("responseRaw")}if(u&&u.error&&u.error.message){l(u.error.code,u.error.target,u&&u.error&&u.error.message)}}else{t.show("File uploaded successfully");n.refresh();i()}}}}return{upload:function(e,t){this.loadFragment({id:"excelUploadDialog",name:"parameterssettings.ext.fragment.Draftattachment",controller:o(this,"MediaFile")}).then(function(e){e.open()})}}});